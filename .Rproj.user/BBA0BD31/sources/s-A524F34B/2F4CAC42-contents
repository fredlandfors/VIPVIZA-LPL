---
title: "VIPVIZA-LPL"
output:
  github_document:
    toc: true
    toc_depth: 4
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

Clear environment:
```{r clearenvironment, include=FALSE}
rm(list = ls())
```

```{r, include=FALSE}
# Load data (hard coded file path):
load("~/projekt_data/2019-03-11_VIPVIZA-ITC_data/rData/markdown.RData")
# Library
library(ggplot2)
```

# Analysis

## Figure 1. Scatter plots, LPL control proteins

[Click here to download high-resolution version](https://github.com/fredlandfors/VIPVIZA-LPL/blob/master/out/figure_1.pdf)

Thumbnail:
```{r echo=FALSE}
figure_1_ggdraw
```


## Figure 2. NMR heatmap, forest plot and bar plot

[Click here to download high-resolution version](https://github.com/fredlandfors/VIPVIZA-LPL/blob/master/out/figure_2.pdf)

Thumbnail:
```{r echo=FALSE}
figure_22
```


## Table 1. Descriptive statistics, study participants.

[Click here to download xlsx file](https://github.com/fredlandfors/VIPVIZA-LPL/blob/master/out/table_1.xlsx)

## Table S1-2. NMR summary stats (S1) and linear regression results (S2)

[Click here to download xlsx file](https://github.com/fredlandfors/VIPVIZA-LPL/blob/master/out/table_S1-2.xlsx)

# Preprocessing
## NMR
### A. Pre-imputation diagnostics

```{r}
dim(unproc_samplemeta)
tempData_samplemeta$data$percent_missing
tempData_samplemeta$plots$vismissplot
```

### B. Post-imputation diagnostics

```{r}
tempData_samplemeta$plots$scatter
tempData_samplemeta$plots$density
```

### C. Outlier analysis

PCA:

```{r}
plot_pca(
  Filter(is.numeric, missData.dataMatrix),
  c = missData.dataMatrix["ID"] 
)$scores_plot

plot_pca(
  Filter(is.numeric, missData.dataMatrix),
  c = missData.dataMatrix["ID"] 
)$loadings_plot
```


Column-wise boxplot:

```{r}
geom_cwiseboxplot(
  x = Filter(is.numeric, missData.dataMatrix),
  c = missData.dataMatrix[,"ID"]
)
```

## Sample metadata
### A. Pre-imputation diagnostics

```{r}
dim(unproc_samplemeta)
tempData_samplemeta$data$percent_missing
tempData_samplemeta$plots$vismissplot
```

### B. Post-imputation diagnostics

```{r}
tempData_samplemeta$plots$scatter
tempData_samplemeta$plots$density
```

### C. Outlier analysis

PCA:

```{r}
plot_pca(
  Filter(is.numeric, na.omit(missData.sampleMetadata)),
  c = na.omit(missData.sampleMetadata)["ID"]
)$scores_plot

plot_pca(
  Filter(is.numeric, na.omit(missData.sampleMetadata)),
  c = na.omit(missData.sampleMetadata)["ID"]
)$loadings_plot
```

Column-wise boxplot:

```{r}
geom_cwiseboxplot(
  x = Filter(is.numeric, missData.sampleMetadata),
  c = missData.sampleMetadata[,"ID"]
)
```

# Session info
```{r}
sessionInfo()
```